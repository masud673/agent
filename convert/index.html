<!DOCTYPE html>  
<html lang="bn">  
<head>  
<meta charset="UTF-8">  
<meta name="viewport" content="width=device-width, initial-scale=1.0">  
<title>এক্সেল থেকে CSV কনভার্টার | YetFix ফরম্যাট</title>  
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>  
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">  
<style>  
:root { --primary:#4a6bff;--secondary:#3a56d4;--accent:#5c8aff;--light:#f8faff;--dark:#2d3748;--success:#4ade80;--warning:#f87171;--border:#e2e8f0;--text:#1a202c;--bg:#f7fafc; }  
*{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI','Nirmala UI','Kalpurush',sans-serif;}  
body{line-height:1.6;color:var(--text);background-color:var(--bg);padding:10px;}  
.container{max-width:900px;margin:0 auto;padding:10px;}  
header{text-align:center;margin-bottom:20px;}  
h1{color:var(--primary);font-size:1.8rem;margin-bottom:8px;font-weight:700;}  
.subtitle{color:var(--dark);opacity:0.8;font-size:0.9rem;}  
.converter-card{background:white;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,0.08);padding:20px;margin-bottom:20px;}  
.form-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:15px;margin-bottom:20px;}  
.form-group{margin-bottom:12px;}  
label{display:block;margin-bottom:6px;font-weight:500;color:var(--dark);font-size:0.85rem;}  
.required-field::after{content:" *";color:var(--warning);}  
input[type="text"]{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:6px;font-size:1rem;transition:all 0.2s;}  
input[type="text"]:focus{border-color:var(--primary);box-shadow:0 0 0 2px rgba(74,107,255,0.15);outline:none;}  
.file-upload{margin-top:20px;}  
.file-upload-label{display:flex;align-items:center;justify-content:center;padding:20px;border:2px dashed var(--border);border-radius:6px;background:var(--light);cursor:pointer;transition:all 0.2s;text-align:center;flex-direction:column;}  
.file-upload-label:hover{border-color:var(--primary);background: rgba(74,107,255,0.05);}  
.file-upload-icon{font-size:1.8rem;color:var(--primary);margin-bottom:8px;}  
.file-upload-text{font-weight:500;margin-bottom:4px;font-size:0.95rem;}  
.file-upload-hint{font-size:0.75rem;color:#64748b;}  
.file-name{margin-top:8px;font-size:0.85rem;color:var(--primary);font-weight:500;}  
#xlsx_file{display:none;}  
.btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 18px;border-radius:6px;font-weight:600;cursor:pointer;transition:all 0.2s;border:none;font-size:0.9rem;}  
.btn-primary{background-color:var(--primary);color:white;box-shadow:0 2px 4px rgba(74,107,255,0.3);}  
.btn-primary:hover{background-color:var(--secondary);transform:translateY(-1px);box-shadow:0 3px 6px rgba(74,107,255,0.4);}  
.btn-primary:active{transform:translateY(0);}  
.btn-secondary{background-color:var(--light);color:var(--primary);border:1px solid var(--border);}  
.btn-secondary:hover{background-color:white;border-color:var(--primary);}  
.btn-icon{margin-right:6px;font-size:0.9rem;}  
.action-buttons{display:flex;gap:12px;margin-top:20px;}  
.loading{display:none;text-align:center;padding:15px;}  
.spinner{width:32px;height:32px;border:3px solid rgba(74,107,255,0.1);border-radius:50%;border-top-color:var(--primary);animation:spin 1s linear infinite;margin:0 auto 12px;}  
@keyframes spin{to{transform:rotate(360deg);}}  
.result-card{background:white;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,0.08);padding:20px;margin-top:20px;display:none;animation:fadeIn 0.3s ease-out;}  
@keyframes fadeIn{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}  
.result-header{display:flex;align-items:center;margin-bottom:15px;}  
.success-icon{color:var(--success);font-size:1.3rem;margin-right:8px;}  
.result-title{font-size:1.1rem;font-weight:600;color:var(--dark);}  
.preview-container{margin-top:15px;}  
.table-responsive{overflow-x:auto;max-width:100%;margin-bottom:12px;border:1px solid var(--border);border-radius:6px;}  
.preview-table{width:100%;border-collapse:collapse;font-size:0.8rem;white-space:nowrap;}  
.preview-table th,.preview-table td{padding:8px 10px;border:1px solid var(--border);text-align:left;}  
.preview-table th{background-color:var(--light);font-weight:600;position:sticky;top:0;}  
.preview-table tr:nth-child(even){background-color: rgba(0,0,0,0.02);}  
.preview-table tr:hover{background-color: rgba(74,107,255,0.05);}  
.preview-note{font-size:0.8rem;color:#64748b;text-align:center;margin-top:8px;}  
.footer{text-align:center;margin-top:30px;color:#64748b;font-size:0.8rem;}  
.creator{font-weight:500;color:var(--primary);}  
@media(max-width:768px){.form-grid{grid-template-columns:1fr;gap:12px;}.action-buttons{flex-direction:column;gap:10px;}.btn{width:100%;}}  
@media(max-width:480px){body{padding:8px;}.container{padding:8px;}h1{font-size:1.6rem;}.converter-card{padding:15px;}input[type="text"]{padding:8px 10px;font-size:0.85rem;}.file-upload-label{padding:15px;}.btn{padding:8px 12px;font-size:0.85rem;}.preview-table th,.preview-table td{padding:6px 8px;font-size:0.75rem;}}  
</style>  
</head>  
<body>  
<div class="container">  
<header>  
<h1>YetFix User Format</h1>  
<p class="subtitle">Convert XLSX to CSV in YetFix required format</p>  
</header>  
<div class="converter-card">  
<form id="converter-form">  
<div class="form-grid">  
<div class="form-group"><label for="package_name" class="required-field">Package Name</label><input type="text" id="package_name" required placeholder="প্যাকেজের নাম লিখুন"></div>  
<div class="form-group"><label for="reseller_name">Reseller Name</label><input type="text" id="reseller_name" placeholder="রিসেলারের নাম লিখুন"></div>  
<div class="form-group"><label for="zone_pop" class="required-field">Zone/Pop</label><input type="text" id="zone_pop" required placeholder="জোন বা পপ লিখুন"></div>  
<div class="form-group"><label for="area">Area</label><input type="text" id="area" placeholder="এলাকা লিখুন"></div>  
<div class="form-group"><label for="division" class="required-field">Division</label><input type="text" id="division" required placeholder="বিভাগ লিখুন"></div>  
<div class="form-group"><label for="district" class="required-field">District</label><input type="text" id="district" required placeholder="জেলা লিখুন"></div>  
<div class="form-group"><label for="upazila" class="required-field">Upazila</label><input type="text" id="upazila" required placeholder="উপজেলা লিখুন"></div>  
</div>  
<div class="action-buttons"><button type="button" id="demo-btn" class="btn btn-secondary"><i class="fas fa-download btn-icon"></i> Download Demo</button></div>  
<div class="file-upload">  
<label for="xlsx_file" class="file-upload-label">  
<div class="file-upload-icon"><i class="fas fa-file-excel"></i></div>  
<div class="file-upload-text">এক্সেল ফাইল নির্বাচন করুন</div>  
<div class="file-upload-hint">অথবা ফাইলটি এখানে ড্রপ করুন</div>  
<div class="file-name" id="file-name-display">কোন ফাইল নির্বাচন করা হয়নি</div>  
</label>  
<input type="file" id="xlsx_file" accept=".xlsx" required>  
</div>  
<div class="action-buttons">  
    <button type="button" id="convert-btn" class="btn btn-primary">  
        <i class="fas fa-exchange-alt btn-icon"></i> Convert to CSV  
    </button>  
</div>  
  
<div id="loading" class="loading">  
  <div class="spinner"></div>  
  <p>আপনার ফাইল প্রসেস করা হচ্ছে...</p>  
</div>  
</form>  
</div>  
  
<div id="result" class="result-card">  
  <div class="result-header">  
    <i class="fas fa-check-circle success-icon"></i>  
    <h2 class="result-title">রূপান্তর সম্পূর্ণ!</h2>  
  </div>  
  <p>আপনার CSV ফাইল ডাউনলোডের জন্য প্রস্তুত। প্রথম কয়েকটি সারির প্রিভিউ:</p>  
  <div class="preview-container">  
    <div class="table-responsive">  
      <table id="csv-preview-table" class="preview-table"></table>  
    </div>  
    <p id="preview-note" class="preview-note"></p>  
  </div>  
  <div class="action-buttons" style="margin-top:25px;">  
    <button id="download-btn" class="btn btn-primary"><i class="fas fa-download btn-icon"></i> CSV ডাউনলোড করুন</button>  
  </div>  
</div>  
  
<div class="footer">  
  <p>Created by <span class="creator">Masud Rana</span> | © 2025 All Rights Reserved</p>  
</div>  
  
  
  
  
<script>  
const xlsxFile = document.getElementById('xlsx_file');  
const fileNameDisplay = document.getElementById('file-name-display');  
  
// ফাইল সিলেকশন/ড্রপ হলে নাম দেখানো  
xlsxFile.addEventListener('change', e=>{  
    const fileName = e.target.files[0] ? e.target.files[0].name : 'কোন ফাইল নির্বাচন করা হয়নি';  
    fileNameDisplay.textContent = fileName;  
});  
  
// ডেমো এক্সেল ডাউনলোড  
document.getElementById('demo-btn').addEventListener('click', ()=>{  
    const demoData = [  
        ["ppoe user","ppoe password","Name","Phone No","expire date"],  
        ["user1@bp","pass123","জহির রায়হান","01712345678","30-12-2025"],  
        ["user2@bp","pass456","আনিসুল হক","01812345678","31-12-2025"]  
    ];  
    const wb = XLSX.utils.book_new();  
    const ws = XLSX.utils.aoa_to_sheet(demoData);  
    XLSX.utils.book_append_sheet(wb, ws, "ব্যবহারকারীরা");  
    const wbout = XLSX.write(wb,{bookType:'xlsx',type:'array'});  
    const blob = new Blob([wbout],{type:'application/octet-stream'});  
    const url = URL.createObjectURL(blob);  
    const a = document.createElement('a');  
    a.href = url;  
    a.download = 'ডেমো_ফরম্যাট.xlsx';  
    document.body.appendChild(a);  
    a.click();  
    setTimeout(()=>{document.body.removeChild(a); URL.revokeObjectURL(url);},0);  
});  
  
// এক্সেল তারিখ যেভাবে আছে ঠিক সেভাবে DD/MM/YYYY বানাবে
function formatDate(value){
    if(!value) return "";
    if(value instanceof Date)
        return `${String(value.getDate()).padStart(2,'0')}/${String(value.getMonth()+1).padStart(2,'0')}/${value.getFullYear()}`;
    if(!isNaN(value)) {
        const d = XLSX.SSF.parse_date_code(value);
        return `${String(d.d).padStart(2,'0')}/${String(d.m).padStart(2,'0')}/${d.y}`;
    }
    return value.toString(); // এক্সেল যদি স্ট্রিং হয় সেটাই ফিরিয়ে দেবে
}
// ফোন নম্বর ফরম্যাট  
function formatPhone(phone){  
    if(!phone) return '';  
    let digits = String(phone).replace(/\D/g,'');  
    if(digits.length===10) digits='0'+digits;  
    return digits;  
}  
  
// CSV প্রিভিউ দেখানো  
function showPreview(data){  
    const table = document.getElementById('csv-preview-table');  
    const note = document.getElementById('preview-note');  
    table.innerHTML="";  
    if(data.length>0){  
        const headerRow = document.createElement('tr');  
        data[0].forEach(h=>{  
            const th = document.createElement('th'); th.textContent=h||''; headerRow.appendChild(th);  
        });  
        table.appendChild(headerRow);  
    }  
    const rows = Math.min(10,data.length);  
    for(let i=1;i<rows;i++){  
        const tr=document.createElement('tr');  
        data[i].forEach(c=>{ const td=document.createElement('td'); td.textContent=c||''; tr.appendChild(td); });  
        table.appendChild(tr);  
    }  
    note.textContent=data.length>rows?`প্রথম ${rows-1}টি সারি দেখানো হচ্ছে (মোট ${data.length-1}টি সারি)`:`মোট ${data.length-1}টি সারি`;  
}  
  
// Convert বাটন ক্লিক  
document.getElementById('convert-btn').addEventListener('click', ()=>{  
    const required=['package_name','zone_pop','division','district','upazila'];  
    const missing=[];  
    required.forEach(id=>{  
        if(!document.getElementById(id).value.trim()){  
            missing.push(document.querySelector(`label[for="${id}"]`).textContent.replace(' *',''));  
        }  
    });  
    if(missing.length){ alert('অনুগ্রহ করে পূরণ করুন:\n'+missing.join(', ')); return; }  
    if(!xlsxFile.files.length){ alert('এক্সেল ফাইল নির্বাচন করুন'); return; }  
  
    document.getElementById('loading').style.display='block';  
    document.getElementById('convert-btn').disabled=true;  
  
    const reader = new FileReader();  
    reader.onload = function(e){  
        const data = new Uint8Array(e.target.result);  
        const wb = XLSX.read(data,{type:'array'});  
        const ws = wb.Sheets[wb.SheetNames[0]];  
        const jsonData = XLSX.utils.sheet_to_json(ws,{header:1});  
  
        // ফর্ম ফিল্ড  
        const packageName=document.getElementById('package_name').value;  
        const resellerName=document.getElementById('reseller_name').value||'N/A';  
        const zonePop=document.getElementById('zone_pop').value;  
        const area=document.getElementById('area').value||'N/A';  
        const division=document.getElementById('division').value;  
        const district=document.getElementById('district').value;  
        const upazila=document.getElementById('upazila').value;  
  
        const finalData=[];  
        // হেডার  
        finalData.push([  
            "ppoe user*","ppoe password*","Name*","Phone No","Packege Name*","Reseller Name","Zone/Pop*","Billing Cycle*",  
            "Email","Father's Name","Mother's Name","Area","Mikrotik Comment","Joining Date","Cable Type","expire date",  
            "customer code","Division*","District*","Upazila*"  
        ]);  
  
        for(let i=1;i<jsonData.length;i++){  
            const row=jsonData[i];  
            if(!row||row.length===0) continue;  
            const expire=formatDate(row[4]);  
            const billingCycle=expire?expire.split('-')[0]:'';  
            finalData.push([  
                row[0]||'',  
                row[1]||'',  
                row[2]||'',  
                formatPhone(row[3]),  
                packageName,  
                resellerName,  
                zonePop,  
                billingCycle,  
                'N/A','N/A','N/A',  
                area,  
                '',  
                '',  
                '',  
                expire,  
                '',  
                division,  
                district,  
                upazila  
            ]);  
        }  
  
        showPreview(finalData);  
  
        const ws2=XLSX.utils.aoa_to_sheet(finalData);  
        const wb2=XLSX.utils.book_new();  
        XLSX.utils.book_append_sheet(wb2, ws2, "YetFix");  
        const wbout=XLSX.write(wb2,{bookType:'csv',type:'array'});  
        const blob=new Blob([wbout],{type:'text/csv'});  
        const url=URL.createObjectURL(blob);  
  
        const downloadBtn=document.getElementById('download-btn');  
        downloadBtn.onclick=()=>{ const a=document.createElement('a'); a.href=url; a.download='YetFix_User.csv'; a.click(); setTimeout(()=>URL.revokeObjectURL(url),0); };  
  
        document.getElementById('loading').style.display='none';  
        document.getElementById('result').style.display='block';  
        document.getElementById('convert-btn').disabled=false;  
    };  
    reader.readAsArrayBuffer(xlsxFile.files[0]);  
});  
</script>  
</body>  
</html>
